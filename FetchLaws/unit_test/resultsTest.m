% clc
% clear
% close all
%% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% Author: Una Schneck (schneck.una@gmail.com)
% 
% This code performs unit testing for the ref variables in the umwm model, valid for:
%
%                   windspeeds = 0.4:1:3.3
%                   m = 31                                                                    
%                   n = 15                                                                  
%                   rho_liquid = 465
%                   nu_liquid = 0.0031/1e4
%                   bathy_map = 100.*ones(m,n)
%
% If you want to unit test for different parameters, re-run UMWM_Titan_FetchLaws and put resulting .mat files in umwm_old folder under unit_test folder
%
%--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% External function requirements:
%   (1) none
%--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% Code produces:
%   (1) List of passed/failed tests
%---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% Aprox time to run: < 1 minute 
%---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% ===========================================================================================================================================================================================================================
% ===========================================================================================================================================================================================================================

% location of .mat files 
addpath('C:\Users\schne\OneDrive\Desktop\Main\Work\MIT\Github_Repos\umwm_titan\FetchLaws\unit_test\umwm_mat\umwm_old') % original model
addpath('C:\Users\schne\OneDrive\Desktop\Main\Work\MIT\Github_Repos\umwm_titan\FetchLaws\unit_test\umwm_mat\umwm_new') % new model with changes

% ===========================================================================================================================================================================================================================
% -- check that grid size is same 
% ===========================================================================================================================================================================================================================
%% Test 1: x dimension of grid
% m: number of gridpoints in x-direction 
load('Old_1_ref.mat','m'); om = m;
load('New_Reference.mat','m'); nm = m;
clearvars m
assert(isequal(om,nm),'m-dimension for original model has changed. Need to re-run original model for unit testing')

%% Test 2: y dimension of grid
% n: number of gridpoints in y-direction
load('Old_1_ref.mat','n'); on = n;
load('New_Reference.mat','n'); nn = n;
clearvars n
assert(isequal(on,nn),'n-dimension for original model has changed. Need to re-run original model for unit testing')

% ===========================================================================================================================================================================================================================
% -- checking that E is the same
% ===========================================================================================================================================================================================================================
%% Test 3: E 1 1
load('Old_1_1.mat','E'); oE = E;
load('New_1_1.mat','E'); nE = E;
clearvars E

assert(isequal(oE,nE),'E Test 1_1: FAIL')

clearvars oE nE

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 4: E 1 2
load('Old_1_2.mat','E'); oE = E;
load('New_1_2.mat','E'); nE = E;

clearvars E

assert(isequal(oE,nE),'E Test 1_2: FAIL')

clearvars oE nE

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 5: E 2 1
load('Old_2_1.mat','E'); oE = E;
load('New_2_1.mat','E'); nE = E;

clearvars E



assert(isequal(oE,nE),'E Test 2_1: FAIL')

clearvars oE nE

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 6: E 2 2
load('Old_2_2.mat','E'); oE = E;
load('New_2_2.mat','E'); nE = E;

clearvars E



assert(isequal(oE,nE),'E Test 2_2: FAIL')

clearvars oE nE

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 7: E 3 1
load('Old_3_1.mat','E'); oE = E;
load('New_3_1.mat','E'); nE = E;





assert(isequal(oE,nE),'E Test 3_1: FAIL')


clearvars oE nE
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 8: E 3 2
load('Old_3_2.mat','E'); oE = E;
load('New_3_2.mat','E'); nE = E;





assert(isequal(oE,nE),'E Test 3_2: FAIL')


% ===========================================================================================================================================================================================================================
% -- checking that ht is the same 
% ===========================================================================================================================================================================================================================
%% Test 9: h1 1 1
load('Old_1_1.mat','ht'); oht = ht;
load('New_1_1.mat','ht'); nht = ht;

clearvars ht



assert(isequal(oht,nht),'ht test 1_1: FAIL')

clearvars oht nht problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 10: ht 1 2
load('Old_1_2.mat','ht'); oht = ht;
load('New_1_2.mat','ht'); nht = ht;

clearvars ht


assert(isequal(oht,nht),'ht test 1_2: FAIL')

clearvars oht nht problem


% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 11: ht 2 1
load('Old_2_1.mat','ht'); oht = ht;
load('New_2_1.mat','ht'); nht = ht;

clearvars ht



assert(isequal(oht,nht),'ht test 2_1: FAIL')


clearvars oht nht problem


% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 12:  ht 2 2
load('Old_2_2.mat','ht'); oht = ht;
load('New_2_2.mat','ht'); nht = ht;

clearvars ht


assert(isequal(oht,nht),'ht test 2_2: FAIL')


clearvars oht nht problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 13: ht 3 1
load('Old_3_1.mat','ht'); oht = ht;
load('New_3_1.mat','ht'); nht = ht;

clearvars ht



assert(isequal(oht,nht),'ht test 3_1: FAIL')

clearvars oht nht problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 14: ht 3 2
load('Old_3_2.mat','ht'); oht = ht;
load('New_3_2.mat','ht'); nht = ht;

clearvars ht



assert(isequal(oht,nht),'ht test 3_2: FAIL')


% ===========================================================================================================================================================================================================================
% -- checking that freqs is the same 
% ===========================================================================================================================================================================================================================
%% Test 15: f 1 1
load('Old_1_1.mat','freqs'); ofreqs = freqs;
load('New_1_1.mat','freqs'); nfreqs = freqs;

clearvars freqs

assert(isequal(nfreqs,ofreqs),'freqs test 1_1: FAIL')

clearvars ofreqs nfreqs
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 16: f 1 2
load('Old_1_2.mat','freqs'); ofreqs = freqs;
load('New_1_2.mat','freqs'); nfreqs = freqs;

clearvars freqs

assert(isequal(nfreqs,ofreqs),'freqs test 1_2: FAIL')


clearvars ofreqs nfreqs
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 17: f 2 1
load('Old_2_1.mat','freqs'); ofreqs = freqs;
load('New_2_1.mat','freqs'); nfreqs = freqs;

clearvars freqs

assert(isequal(nfreqs,ofreqs),'freqs test 2_1: FAIL')

clearvars ofreqs nfreqs
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 18: f 2 2
load('Old_2_2.mat','freqs'); ofreqs = freqs;
load('New_2_2.mat','freqs'); nfreqs = freqs;

clearvars freqs

assert(isequal(nfreqs,ofreqs),'freqs test 2_2: FAIL')

clearvars ofreqs nfreqs
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 19: f 3 1
load('Old_3_1.mat','freqs'); ofreqs = freqs;
load('New_3_1.mat','freqs'); nfreqs = freqs;

clearvars freqs

assert(isequal(nfreqs,ofreqs),'freqs test 3_1: FAIL')

clearvars ofreqs nfreqs
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 20: f 3 2
load('Old_3_2.mat','freqs'); ofreqs = freqs;
load('New_3_2.mat','freqs'); nfreqs = freqs;

clearvars freqs

assert(isequal(nfreqs,ofreqs),'freqs test 3_2: FAIL')


% ===========================================================================================================================================================================================================================
% -- checking that Cd is the same -- %
% ===========================================================================================================================================================================================================================
%% Test 21: Cd 1 1
load('Old_1_1.mat','Cd'); oCd = Cd;
load('New_1_1.mat','Cd'); nCd = Cd;

clearvars Cd



assert(isequal(oCd,nCd),'Cd test 1_1: FAIL')

clearvars oCd nCd problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 22: Cd 1 2
load('Old_1_2.mat','Cd'); oCd = Cd;
load('New_1_2.mat','Cd'); nCd = Cd;

clearvars Cd



assert(isequal(oCd,nCd),'Cd test 1_2: FAIL')


clearvars oCd nCd problem


% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 23: Cd 2 1
load('Old_2_1.mat','Cd'); oCd = Cd;
load('New_2_1.mat','Cd'); nCd = Cd;

clearvars Cd



assert(isequal(oCd,nCd),'Cd test 2_1: FAIL')

clearvars oCd nCd problem


% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 24: Cd 2 2
load('Old_2_2.mat','Cd'); oCd = Cd;
load('New_2_2.mat','Cd'); nCd = Cd;

clearvars Cd



assert(isequal(oCd,nCd),'Cd test 2_2: FAIL')

clearvars oCd nCd problem
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 25: Cd 3 1 
load('Old_3_1.mat','Cd'); oCd = Cd;
load('New_3_1.mat','Cd'); nCd = Cd;

clearvars Cd



assert(isequal(oCd,nCd),'Cd test 3_1: FAIL')

clearvars oCd nCd problem


% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 26: Cd 3 2 
load('Old_3_2.mat','Cd'); oCd = Cd;
load('New_3_2.mat','Cd'); nCd = Cd;

clearvars Cd



assert(isequal(oCd,nCd),'Cd test 3_2: FAIL')


% ===========================================================================================================================================================================================================================
% -- checking that Cdf is the same
% ===========================================================================================================================================================================================================================
%% Test 27: Cdf 1 1
load('Old_1_1.mat','Cdf'); oCdf = Cdf;
load('New_1_1.mat','Cdf'); nCdf = Cdf;

clearvars Cdf



assert(isequal(oCdf,nCdf),'Cdf test 1_1: FAIL')

clearvars oCdf nCdf problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 28: Cdf 1 2
load('Old_1_2.mat','Cdf'); oCdf = Cdf;
load('New_1_2.mat','Cdf'); nCdf = Cdf;

clearvars Cdf



assert(isequal(oCdf,nCdf),'Cdf test 1_2: FAIL')

clearvars oCdf nCdf problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 29: Cdf 2 1
load('Old_2_1.mat','Cdf'); oCdf = Cdf;
load('New_2_1.mat','Cdf'); nCdf = Cdf;

clearvars Cdf



assert(isequal(oCdf,nCdf),'Cdf test 2_1: FAIL')

clearvars oCdf nCdf problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 30: Cdf 2 2
load('Old_2_2.mat','Cdf'); oCdf = Cdf;
load('New_2_2.mat','Cdf'); nCdf = Cdf;

clearvars Cdf



assert(isequal(oCdf,nCdf),'Cdf test 2_2: FAIL')


clearvars oCdf nCdf problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 31: Cdf 3 1 
load('Old_3_1.mat','Cdf'); oCdf = Cdf;
load('New_3_1.mat','Cdf'); nCdf = Cdf;

clearvars Cdf



assert(isequal(oCdf,nCdf),'Cdf test 3_1: FAIL')

clearvars oCdf nCdf problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 32: Cdf 3 2
load('Old_3_2.mat','Cdf'); oCdf = Cdf;
load('New_3_2.mat','Cdf'); nCdf = Cdf;

clearvars Cdf



assert(isequal(oCdf,nCdf),'Cdf test 1_2: FAIL')

% ===========================================================================================================================================================================================================================
% -- checking that Cds is the same 
% ===========================================================================================================================================================================================================================
%% Test 33: Cds 1 1
load('Old_1_1.mat','Cds'); oCds = Cds;
load('New_1_1.mat','Cds'); nCds = Cds;

clearvars Cds



assert(isequal(oCds,nCds),'Cds test 1_1: FAIL')

clearvars oCds nCds problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 34: Cds 1 2
load('Old_1_2.mat','Cds'); oCds = Cds;
load('New_1_2.mat','Cds'); nCds = Cds;

clearvars Cds



assert(isequal(oCds,nCds),'Cds test 1_2: FAIL')


clearvars oCds nCds problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 35: Cds 2 1
load('Old_2_1.mat','Cds'); oCds = Cds;
load('New_2_1.mat','Cds'); nCds = Cds;

clearvars Cds



assert(isequal(oCds,nCds),'Cds test 2_1: FAIL')


clearvars oCds nCds problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 36: Cds 2 2
load('Old_2_2.mat','Cds'); oCds = Cds;
load('New_2_2.mat','Cds'); nCds = Cds;

clearvars Cds



assert(isequal(oCds,nCds),'Cds test 2_2: FAIL')


clearvars oCds nCds problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 37: Cds 3 1
load('Old_3_1.mat','Cds'); oCds = Cds;
load('New_3_1.mat','Cds'); nCds = Cds;

clearvars Cds



assert(isequal(oCds,nCds),'Cds test 3_1: FAIL')


clearvars oCds nCds problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 38: Cds 3 2
load('Old_3_2.mat','Cds'); oCds = Cds;
load('New_3_2.mat','Cds'); nCds = Cds;

clearvars Cds



assert(isequal(oCds,nCds),'Cds test 3_2: FAIL')

% ===========================================================================================================================================================================================================================
% -- checking that Sin is the same 
% ===========================================================================================================================================================================================================================
%% Test 39: Sin 1 1
load('Old_1_1.mat','Sin'); oSin = Sin;
load('New_1_1.mat','Sin'); nSin = Sin;




assert(isequal(oSin,nSin),'Sin Test 1_1: FAI')

clearvars oSin nSin
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 40: Sin 1 2
load('Old_1_2.mat','Sin'); oSin = Sin;
load('New_1_2.mat','Sin'); nSin = Sin;




assert(isequal(oSin,nSin),'Sin Test 1_2: FAI')

clearvars oSin nSin
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 41: Sin 2 1
load('Old_2_1.mat','Sin'); oSin = Sin;
load('New_2_1.mat','Sin'); nSin = Sin;




assert(isequal(oSin,nSin),'Sin Test 2_1: FAI')


clearvars oSin nSin
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 42: Sin 2 2
load('Old_2_2.mat','Sin'); oSin = Sin;
load('New_2_2.mat','Sin'); nSin = Sin;




assert(isequal(oSin,nSin),'Sin Test 2_2: FAI')

clearvars oSin nSin
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 43: Sin 3 1 
load('Old_3_1.mat','Sin'); oSin = Sin;
load('New_3_1.mat','Sin'); nSin = Sin;



assert(isequal(oSin,nSin),'Sin Test 3_1: FAI')



clearvars oSin nSin
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 44: Sin 3 2 
load('Old_3_2.mat','Sin'); oSin = Sin;
load('New_3_2.mat','Sin'); nSin = Sin;



assert(isequal(oSin,nSin),'Sin Test 3_2: FAI')





% ===========================================================================================================================================================================================================================
% -- checking that Sds_wc is the same 
% ===========================================================================================================================================================================================================================
%% Test 45: Sds_wc 1 1
load('Old_1_1.mat','Sds_wc'); oSds_wc = Sds_wc;
load('New_1_1.mat','Sds_wc'); nSds_wc = Sds_wc;




assert(isequal(oSds_wc,nSds_wc),'Sds_wc Test 1_1: FAIL')


clearvars oSds_wc nSds_wc
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 46: Sds_wc 1 2
load('Old_1_2.mat','Sds_wc'); oSds_wc = Sds_wc;
load('New_1_2.mat','Sds_wc'); nSds_wc = Sds_wc;




assert(isequal(oSds_wc,nSds_wc),'Sds_wc Test 1_2: FAIL')


clearvars oSds_wc nSds_wc
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 47: Sds_wc 2 1
load('Old_2_1.mat','Sds_wc'); oSds_wc = Sds_wc;
load('New_2_1.mat','Sds_wc'); nSds_wc = Sds_wc;




assert(isequal(oSds_wc,nSds_wc),'Sds_wc Test 2_1: FAIL')



clearvars oSds_wc nSds_wc
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 48: Sds_wc 2 2
load('Old_2_2.mat','Sds_wc'); oSds_wc = Sds_wc;
load('New_2_2.mat','Sds_wc'); nSds_wc = Sds_wc;



assert(isequal(oSds_wc,nSds_wc),'Sds_wc Test 2_2: FAIL')



clearvars oSds_wc nSds_wc
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 49: Sds_wc 3 1
load('Old_3_1.mat','Sds_wc'); oSds_wc = Sds_wc;
load('New_3_1.mat','Sds_wc'); nSds_wc = Sds_wc;



assert(isequal(oSds_wc,nSds_wc),'Sds_wc Test 3_1: FAIL')



clearvars oSds_wc nSds_wc
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 50: Sds_wc 3 2
load('Old_3_2.mat','Sds_wc'); oSds_wc = Sds_wc;
load('New_3_2.mat','Sds_wc'); nSds_wc = Sds_wc;



assert(isequal(oSds_wc,nSds_wc),'Sds_wc Test 3_2: FAIL')


% ===========================================================================================================================================================================================================================
% -- checking that Sds is the same 
% ===========================================================================================================================================================================================================================
% ---------------------------------------------- %
%% Test 51: Sds 1 1
load('Old_1_1.mat','Sds'); oSds = Sds;
load('New_1_1.mat','Sds'); nSds = Sds;



assert(isequal(oSds,nSds),'Sds Test 1_1: FAIL')


clearvars oSds nSds
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 52: Sds 1 2
load('Old_1_2.mat','Sds'); oSds = Sds;
load('New_1_2.mat','Sds'); nSds = Sds;



assert(isequal(oSds,nSds),'Sds Test 1_2: FAIL')


clearvars oSds nSds
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 53: Sds 2 1
load('Old_2_1.mat','Sds'); oSds = Sds;
load('New_2_1.mat','Sds'); nSds = Sds;



assert(isequal(oSds,nSds),'Sds Test 2_1: FAIL')


clearvars oSds nSds
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 54: Sds 2 2
load('Old_2_2.mat','Sds'); oSds = Sds;
load('New_2_2.mat','Sds'); nSds = Sds;





assert(isequal(oSds,nSds),'Sds Test 2_2: FAIL')

clearvars oSds nSds
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 55: Sds 3 1
load('Old_3_1.mat','Sds'); oSds = Sds;
load('New_3_1.mat','Sds'); nSds = Sds;



assert(isequal(oSds,nSds),'Sds Test 3_1: FAIL')


clearvars oSds nSds
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 56: Sds 3 2
load('Old_3_2.mat','Sds'); oSds = Sds;
load('New_3_2.mat','Sds'); nSds = Sds;




assert(isequal(oSds,nSds),'Sds Test 3_2: FAIL')

% ===========================================================================================================================================================================================================================
% -- checking that Snl is the same 
% ===========================================================================================================================================================================================================================
%% Test 57: Snl 1 1
load('Old_1_1.mat','Snl'); oSnl = Snl;
load('New_1_1.mat','Snl'); nSnl = Snl;




assert(isequal(oSnl,nSnl),'Snl Test 1_1: FAIL')


clearvars oSnl nSnl
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 58: Snl 1 2
load('Old_1_2.mat','Snl'); oSnl = Snl;
load('New_1_2.mat','Snl'); nSnl = Snl;



assert(isequal(oSnl,nSnl),'Snl Test 1_2: FAIL')


clearvars oSnl nSnl
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 59: Snl 2 1
load('Old_2_1.mat','Snl'); oSnl = Snl;
load('New_2_1.mat','Snl'); nSnl = Snl;



assert(isequal(oSnl,nSnl),'Snl Test 2_1: FAIL')


clearvars oSnl nSnl
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 60: Snl 2 2
load('Old_2_2.mat','Snl'); oSnl = Snl;
load('New_2_2.mat','Snl'); nSnl = Snl;



assert(isequal(oSnl,nSnl),'Snl Test 2_2: FAIL')


clearvars oSnl nSnl
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 61: Snl 3 1
load('Old_3_1.mat','Snl'); oSnl = Snl;
load('New_3_1.mat','Snl'); nSnl = Snl;


assert(isequal(oSnl,nSnl),'Snl Test 3_1: FAIL')


clearvars oSnl nSnl
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 62: Snl 3 2
load('Old_3_2.mat','Snl'); oSnl = Snl;
load('New_3_2.mat','Snl'); nSnl = Snl;



assert(isequal(oSnl,nSnl),'Snl Test 3_2: FAIL')


% ===========================================================================================================================================================================================================================
% -- checking that Sdt is the same 
% ===========================================================================================================================================================================================================================
%% Test 63: Sdt 1 1
load('Old_1_1.mat','Sdt'); oSdt = Sdt;
load('New_1_1.mat','Sdt'); nSdt = Sdt;




assert(isequal(oSdt,nSdt),'Sdt Test 1_1: FAIL')


clearvars oSdt nSdt
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 64: Sdt 1 2
load('Old_1_2.mat','Sdt'); oSdt = Sdt;
load('New_1_2.mat','Sdt'); nSdt = Sdt;





assert(isequal(oSdt,nSdt),'Sdt Test 1_2: FAIL')


clearvars oSdt nSdt
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 65: Sdt 2 1
load('Old_2_1.mat','Sdt'); oSdt = Sdt;
load('New_2_1.mat','Sdt'); nSdt = Sdt;




assert(isequal(oSdt,nSdt),'Sdt Test 2_1: FAIL')


clearvars oSdt nSdt
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 66: Sdt 2 2
load('Old_2_2.mat','Sdt'); oSdt = Sdt;
load('New_2_2.mat','Sdt'); nSdt = Sdt;





assert(isequal(oSdt,nSdt),'Sdt Test 2_2: FAIL')


clearvars oSdt nSdt
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 67: Sdt 3 1
load('Old_3_1.mat','Sdt'); oSdt = Sdt;
load('New_3_1.mat','Sdt'); nSdt = Sdt;




assert(isequal(oSdt,nSdt),'Sdt Test 3_1: FAIL')


clearvars oSdt nSdt
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 68: Sdt 3 2
load('Old_3_2.mat','Sdt'); oSdt = Sdt;
load('New_3_2.mat','Sdt'); nSdt = Sdt;





assert(isequal(oSdt,nSdt),'Sdt Test 3_2: FAIL')



% ===========================================================================================================================================================================================================================
% -- checking that Sbf is the same 
% ===========================================================================================================================================================================================================================
%% Test 69: Sbf 1 1
load('Old_1_1.mat','Sbf'); oSbf = Sbf;
load('New_1_1.mat','Sbf'); nSbf = Sbf;




assert(isequal(oSbf,nSbf),'Sbf Test 1_1: FAIL')


clearvars oSbf nSbf
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 70: Sbf 1 2
load('Old_1_2.mat','Sbf'); oSbf = Sbf;
load('New_1_2.mat','Sbf'); nSbf = Sbf;



assert(isequal(oSbf,nSbf),'Sbf Test 1_2: FAIL')

clearvars oSbf nSbf

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 71: Sbf 2 1 
load('Old_2_1.mat','Sbf'); oSbf = Sbf;
load('New_2_1.mat','Sbf'); nSbf = Sbf;



assert(isequal(oSbf,nSbf),'Sbf Test 2_1: FAIL')

clearvars oSbf nSbf
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 72: Sbf 2 2
load('Old_2_2.mat','Sbf'); oSbf = Sbf;
load('New_2_2.mat','Sbf'); nSbf = Sbf;



assert(isequal(oSbf,nSbf),'Sbf Test 2_2: FAIL')

clearvars oSbf nSbf
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 73: Sbf 3 1
load('Old_3_1.mat','Sbf'); oSbf = Sbf;
load('New_3_1.mat','Sbf'); nSbf = Sbf;



assert(isequal(oSbf,nSbf),'Sbf Test 3_1: FAIL')

clearvars oSbf nSbf
% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 74: Sbf 3 2
load('Old_3_2.mat','Sbf'); oSbf = Sbf;
load('New_3_2.mat','Sbf'); nSbf = Sbf;




assert(isequal(oSbf,nSbf),'Sbf Test 3_2: FAIL')

% ===========================================================================================================================================================================================================================
% -- checking that ms is the same 
% ===========================================================================================================================================================================================================================
%% Test 75: ms 1 1
load('Old_1_1.mat','ms'); oms = ms;
load('New_1_1.mat','ms'); nms = ms;

clearvars ms


assert(isequal(oms,nms),'ms test 1_1: FAIL')



clearvars oms nms problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 76: ms 1 2
load('Old_1_2.mat','ms'); oms = ms;
load('New_1_2.mat','ms'); nms = ms;

clearvars ms


assert(isequal(oms,nms),'ms test 1_2: FAIL')


clearvars oms nms problem


% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 77: ms 2 1
load('Old_2_1.mat','ms'); oms = ms;
load('New_2_1.mat','ms'); nms = ms;

clearvars ms



assert(isequal(oms,nms),'ms test 2_1: FAIL')


clearvars oms nms problem


% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 78: ms 2 2
load('Old_2_2.mat','ms'); oms = ms;
load('New_2_2.mat','ms'); nms = ms;

clearvars ms



assert(isequal(oms,nms),'ms test 2_2: FAIL')


clearvars oms nms problem

% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 79: ms 3 1
load('Old_3_1.mat','ms'); oms = ms;
load('New_3_1.mat','ms'); nms = ms;

clearvars ms



assert(isequal(oms,nms),'ms test 3_1: FAIL')

clearvars oms nms problem


% --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
%% Test 80: ms 3 2
load('Old_3_2.mat','ms'); oms = ms;
load('New_3_2.mat','ms'); nms = ms;

clearvars ms



assert(isequal(oms,nms),'ms test 3_2: FAIL')

disp('ms tests done')

% ===========================================================================================================================================================================================================================
% ===========================================================================================================================================================================================================================

